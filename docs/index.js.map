{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/Button.ts","webpack:///./src/Food.ts","webpack:///./src/Matrix.ts","webpack:///./src/NeuralNet.ts","webpack:///./src/Population.ts","webpack:///./src/Snake.ts","webpack:///./src/index.ts"],"names":[],"mappings":"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","file":"./index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","/// <reference path=\"./global.d.ts\" />\n\nimport * as p5_global from \"p5/global\"\nimport * as p5 from \"p5\"\n\nexport class Button\n{\n    private x: number;\n    private y: number;\n    private w: number;\n    private h: number;\n    private text: string;\n\n    constructor(x: number, y: number, w: number, h: number, t: string)\n    {\n        this.x = x;\n        this.y = y;\n        this.w = w;\n        this.h = h;\n        this.text = t;\n    }\n\n    collide(x: number, y: number)\n    {\n        if (x >= this.x - this.w / 2 && x <= this.x + this.w / 2 && y >= this.y - this.h / 2 && y <= this.y + this.h / 2)\n        {\n            return true;\n        }\n        return false;\n    }\n\n    show()\n    {\n        fill(255);\n        stroke(0);\n        rectMode(CENTER);\n        rect(this.x, this.y, this.w, this.h);\n        textSize(22);\n        textAlign(CENTER, CENTER);\n        fill(0);\n        noStroke();\n        text(this.text, this.x, this.y - 3);\n    }\n}","/// <reference path=\"./global.d.ts\" />\r\n\r\nimport * as p5_global from \"p5/global\"\r\nimport * as p5 from \"p5\"\r\n\r\nexport class Food\r\n{\r\n    public pos: p5.Vector;\r\n\r\n    constructor()\r\n    {\r\n        let x: number = 400 + SIZE + Math.floor(random(38)) * SIZE;\r\n        let y: number = SIZE + Math.floor(random(38)) * SIZE;\r\n\r\n        this.pos = createVector(x, y);\r\n    }\r\n\r\n    show()\r\n    {\r\n        stroke(0);\r\n        fill(255, 0, 0);\r\n        rect(this.pos.x, this.pos.y, SIZE, SIZE);\r\n    }\r\n\r\n    clone()\r\n    {\r\n        let clone = new Food();\r\n\r\n        clone.pos.x = this.pos.x;\r\n        clone.pos.y = this.pos.y;\r\n\r\n        return clone;\r\n    }\r\n}\r\n","/// <reference path=\"./global.d.ts\" />\r\n\r\nimport * as p5_global from \"p5/global\"\r\nimport * as p5 from \"p5\"\r\n\r\nexport class Matrix\r\n{\r\n    public rows: number;\r\n    public cols: number;\r\n    public matrix: number[][];\r\n\r\n    constructor(r: number, c: number)\r\n    {\r\n        this.rows = r;\r\n        this.cols = c;\r\n        this.matrix = []\r\n\r\n        for (let y = 0; y < r; y++)\r\n        {\r\n            this.matrix[y] = [];\r\n        }\r\n    }\r\n\r\n    static FromMatrix(m: number[][]): Matrix\r\n    {\r\n        let matrix = new Matrix(0, 0);\r\n\r\n        matrix.matrix = m;\r\n        matrix.rows = m.length;\r\n        matrix.cols = m[0].length;\r\n\r\n        return matrix;\r\n    }\r\n\r\n    dot(n: Matrix): Matrix\r\n    {\r\n        let result = new Matrix(this.rows, n.cols);\r\n\r\n        if (this.cols == n.rows)\r\n        {\r\n            for (let i = 0; i < this.rows; i++)\r\n            {\r\n                for (let j = 0; j < n.cols; j++)\r\n                {\r\n                    let sum = 0;\r\n                    for (let k = 0; k < this.cols; k++)\r\n                    {\r\n                        sum += this.matrix[i][k] * n.matrix[k][j];\r\n                    }\r\n                    result.matrix[i][j] = sum;\r\n                }\r\n            }\r\n        } else\r\n        {\r\n            console.warn(\"cols not equals rows\")\r\n        }\r\n        return result;\r\n    }\r\n\r\n    randomize(): void\r\n    {\r\n        for (let i = 0; i < this.rows; i++)\r\n        {\r\n            for (let j = 0; j < this.cols; j++)\r\n            {\r\n                this.matrix[i][j] = random(-1, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    static singleColumnMatrixFromArray(arr: number[]): Matrix\r\n    {\r\n        let n = new Matrix(arr.length, 1);\r\n        for (let i = 0; i < arr.length; i++)\r\n        {\r\n            n.matrix[i][0] = arr[i];\r\n        }\r\n        return n;\r\n    }\r\n\r\n    toArray(): number[]\r\n    {\r\n        let arr: number[] = []\r\n\r\n        for (let i = 0; i < this.rows; i++)\r\n        {\r\n            for (let j = 0; j < this.cols; j++)\r\n            {\r\n                arr[j + i * this.cols] = this.matrix[i][j];\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    addBias(): Matrix\r\n    {\r\n        let n = new Matrix(this.rows + 1, 1);\r\n\r\n        for (let i = 0; i < this.rows; i++)\r\n        {\r\n            n.matrix[i][0] = this.matrix[i][0];\r\n        }\r\n\r\n        n.matrix[this.rows][0] = 1;\r\n\r\n        return n;\r\n    }\r\n\r\n    activate()\r\n    {\r\n        let n = new Matrix(this.rows, this.cols);\r\n        for (let i = 0; i < this.rows; i++)\r\n        {\r\n            for (let j = 0; j < this.cols; j++)\r\n            {\r\n                n.matrix[i][j] = this.relu(this.matrix[i][j]);\r\n            }\r\n        }\r\n        return n;\r\n    }\r\n\r\n    relu(x: number)\r\n    {\r\n        return max(0, x);\r\n    }\r\n\r\n    mutate(mutationRate: number)\r\n    {\r\n        for (let i = 0; i < this.rows; i++)\r\n        {\r\n            for (let j = 0; j < this.cols; j++)\r\n            {\r\n                let rand = random(0, 1);\r\n                if (rand < mutationRate)\r\n                {\r\n                    this.matrix[i][j] += randomGaussian(0, 1) / 5;\r\n\r\n                    if (this.matrix[i][j] > 1)\r\n                    {\r\n                        this.matrix[i][j] = 1;\r\n                    }\r\n                    if (this.matrix[i][j] < -1)\r\n                    {\r\n                        this.matrix[i][j] = -1;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    crossover(partner: Matrix): Matrix\r\n    {\r\n        let child = new Matrix(this.rows, this.cols);\r\n\r\n        let randC = Math.floor(random(this.cols));\r\n        let randR = Math.floor(random(this.rows));\r\n\r\n        for (let i = 0; i < this.rows; i++)\r\n        {\r\n            for (let j = 0; j < this.cols; j++)\r\n            {\r\n                if ((i < randR) || (i == randR && j <= randC))\r\n                {\r\n                    child.matrix[i][j] = this.matrix[i][j];\r\n                } else\r\n                {\r\n                    child.matrix[i][j] = partner.matrix[i][j];\r\n                }\r\n            }\r\n        }\r\n        return child;\r\n    }\r\n\r\n    clone(): Matrix\r\n    {\r\n        let clone = new Matrix(this.rows, this.cols);\r\n        for (let i = 0; i < this.rows; i++)\r\n        {\r\n            for (let j = 0; j < this.cols; j++)\r\n            {\r\n                clone.matrix[i][j] = this.matrix[i][j];\r\n            }\r\n        }\r\n        return clone;\r\n    }\r\n}\r\n","/// <reference path=\"./global.d.ts\" />\r\n\r\nimport * as p5_global from \"p5/global\"\r\nimport * as p5 from \"p5\"\r\n\r\nimport { Matrix } from \"./Matrix\";\r\n\r\nexport class NeuralNet\r\n{\r\n    private iNodes: number;\r\n    private hNodes: number;\r\n    private oNodes: number;\r\n    private hLayers: number;\r\n    private weights: Matrix[];\r\n\r\n    constructor(input: number, hidden: number, output: number, hiddenLayers: number)\r\n    {\r\n        this.iNodes = input;\r\n        this.hNodes = hidden;\r\n        this.oNodes = output;\r\n        this.hLayers = hiddenLayers;\r\n\r\n        this.weights = [];\r\n        this.weights.push(new Matrix(this.hNodes, this.iNodes + 1));\r\n        for (let i = 1; i < this.hLayers; i++)\r\n        {\r\n            this.weights.push(new Matrix(this.hNodes, this.hNodes + 1));\r\n        }\r\n        this.weights.push(new Matrix(this.oNodes, this.hNodes + 1));\r\n\r\n        for (let w of this.weights)\r\n        {\r\n            w.randomize();\r\n        }\r\n    }\r\n\r\n    mutate(mr: number)\r\n    {\r\n        for (let w of this.weights)\r\n        {\r\n            w.mutate(mr);\r\n        }\r\n    }\r\n\r\n    output(inputsArr: number[]): number[]\r\n    {\r\n        let inputs = Matrix.singleColumnMatrixFromArray(inputsArr);\r\n        let curr_bias = inputs.addBias();\r\n\r\n        for (let i = 0; i < this.hLayers; i++)\r\n        {\r\n            let hidden_ip = this.weights[i].dot(curr_bias);\r\n            let hidden_op = hidden_ip.activate();\r\n            curr_bias = hidden_op.addBias();\r\n        }\r\n\r\n        let output_ip = this.weights[this.weights.length - 1].dot(curr_bias);\r\n        let output = output_ip.activate();\r\n\r\n        return output.toArray();\r\n    }\r\n\r\n    crossover(partner: NeuralNet): NeuralNet\r\n    {\r\n        let child = new NeuralNet(this.iNodes, this.hNodes, this.oNodes, this.hLayers);\r\n        for (let i = 0; i < this.weights.length; i++)\r\n        {\r\n            child.weights[i] = this.weights[i].crossover(partner.weights[i]);\r\n        }\r\n        return child;\r\n    }\r\n\r\n    clone(): NeuralNet\r\n    {\r\n        let clone = new NeuralNet(this.iNodes, this.hNodes, this.oNodes, this.hLayers);\r\n        for (let i = 0; i < this.weights.length; i++)\r\n        {\r\n            clone.weights[i] = this.weights[i].clone();\r\n        }\r\n\r\n        return clone;\r\n    }\r\n\r\n    load(weight: Matrix[]): void\r\n    {\r\n        for (let i = 0; i < this.weights.length; i++)\r\n        {\r\n            this.weights[i] = weight[i];\r\n        }\r\n    }\r\n\r\n    pull(): Matrix[]\r\n    {\r\n        let model: Matrix[] = []\r\n\r\n        for (let w of this.weights)\r\n        {\r\n            model.push(w.clone());\r\n        }\r\n\r\n        return model;\r\n    }\r\n\r\n    show(x: number, y: number, w: number, h: number, vision: number[], decision: number[])\r\n    {\r\n        let space = 5;\r\n        let nSize = (h - (space * (this.iNodes - 2))) / this.iNodes;\r\n        let nSpace = (w - (this.weights.length * nSize)) / this.weights.length;\r\n        let hBuff = (h - (space * (this.hNodes - 1)) - (nSize * this.hNodes)) / 2;\r\n        let oBuff = (h - (space * (this.oNodes - 1)) - (nSize * this.oNodes)) / 2;\r\n\r\n        let maxIndex = 0;\r\n\r\n        for (let i = 1; i < decision.length; i++)\r\n        {\r\n            if (decision[i] > decision[maxIndex])\r\n            {\r\n                maxIndex = i;\r\n            }\r\n        }\r\n\r\n        let lc = 0;  //Layer Count\r\n\r\n        //DRAW NODES\r\n        for (let i = 0; i < this.iNodes; i++)\r\n        {  //DRAW INPUTS\r\n            if (vision[i] != 0)\r\n            {\r\n                fill(0, 255, 0);\r\n            } else\r\n            {\r\n                fill(255);\r\n            }\r\n            stroke(0);\r\n            ellipseMode(CORNER);\r\n            ellipse(x, y + (i * (nSize + space)), nSize, nSize);\r\n            textSize(nSize / 2);\r\n            textAlign(CENTER, CENTER);\r\n            fill(0);\r\n            text(i, x + (nSize / 2), y + (nSize / 2) + (i * (nSize + space)));\r\n        }\r\n\r\n        lc++;\r\n\r\n        for (let a = 0; a < this.hLayers; a++)\r\n        {\r\n            for (let i = 0; i < this.hNodes; i++)\r\n            {  //DRAW HIDDEN\r\n                fill(255);\r\n                stroke(0);\r\n                ellipseMode(CORNER);\r\n                ellipse(x + (lc * nSize) + (lc * nSpace), y + hBuff + (i * (nSize + space)), nSize, nSize);\r\n            }\r\n            lc++;\r\n        }\r\n\r\n        for (let i = 0; i < this.oNodes; i++)\r\n        {  //DRAW OUTPUTS\r\n            if (i == maxIndex)\r\n            {\r\n                fill(0, 255, 0);\r\n            } else\r\n            {\r\n                fill(255);\r\n            }\r\n            stroke(0);\r\n            ellipseMode(CORNER);\r\n            ellipse(x + (lc * nSpace) + (lc * nSize), y + oBuff + (i * (nSize + space)), nSize, nSize);\r\n        }\r\n\r\n        lc = 1;\r\n\r\n        //DRAW WEIGHTS\r\n        for (let i = 0; i < this.weights[0].rows; i++)\r\n        {  //INPUT TO HIDDEN\r\n            for (let j = 0; j < this.weights[0].cols - 1; j++)\r\n            {\r\n                if (this.weights[0].matrix[i][j] < 0)\r\n                {\r\n                    stroke(255, 0, 0);\r\n                } else\r\n                {\r\n                    stroke(0, 0, 255);\r\n                }\r\n                line(x + nSize, y + (nSize / 2) + (j * (space + nSize)), x + nSize + nSpace, y + hBuff + (nSize / 2) + (i * (space + nSize)));\r\n            }\r\n        }\r\n\r\n        lc++;\r\n\r\n        for (let a = 1; a < this.hLayers; a++)\r\n        {\r\n            for (let i = 0; i < this.weights[a].rows; i++)\r\n            {  //HIDDEN TO HIDDEN\r\n                for (let j = 0; j < this.weights[a].cols - 1; j++)\r\n                {\r\n                    if (this.weights[a].matrix[i][j] < 0)\r\n                    {\r\n                        stroke(255, 0, 0);\r\n                    } else\r\n                    {\r\n                        stroke(0, 0, 255);\r\n                    }\r\n                    line(x + (lc * nSize) + ((lc - 1) * nSpace), y + hBuff + (nSize / 2) + (j * (space + nSize)), x + (lc * nSize) + (lc * nSpace), y + hBuff + (nSize / 2) + (i * (space + nSize)));\r\n                }\r\n            }\r\n            lc++;\r\n        }\r\n\r\n        for (let i = 0; i < this.weights[this.weights.length - 1].rows; i++)\r\n        {  //HIDDEN TO OUTPUT\r\n            for (let j = 0; j < this.weights[this.weights.length - 1].cols - 1; j++)\r\n            {\r\n                if (this.weights[this.weights.length - 1].matrix[i][j] < 0)\r\n                {\r\n                    stroke(255, 0, 0);\r\n                } else\r\n                {\r\n                    stroke(0, 0, 255);\r\n                }\r\n                line(x + (lc * nSize) + ((lc - 1) * nSpace), y + hBuff + (nSize / 2) + (j * (space + nSize)), x + (lc * nSize) + (lc * nSpace), y + oBuff + (nSize / 2) + (i * (space + nSize)));\r\n            }\r\n        }\r\n\r\n        fill(0);\r\n        textSize(15);\r\n        textAlign(CENTER, CENTER);\r\n        text(\"U\", x + (lc * nSize) + (lc * nSpace) + nSize / 2, y + oBuff + (nSize / 2));\r\n        text(\"D\", x + (lc * nSize) + (lc * nSpace) + nSize / 2, y + oBuff + space + nSize + (nSize / 2));\r\n        text(\"L\", x + (lc * nSize) + (lc * nSpace) + nSize / 2, y + oBuff + (2 * space) + (2 * nSize) + (nSize / 2));\r\n        text(\"R\", x + (lc * nSize) + (lc * nSpace) + nSize / 2, y + oBuff + (3 * space) + (3 * nSize) + (nSize / 2));\r\n    }\r\n}\r\n","/// <reference path=\"./global.d.ts\" />\r\n\r\nimport * as p5_global from \"p5/global\"\r\nimport * as p5 from \"p5\"\r\n\r\nimport { Snake } from \"./Snake\";\r\n\r\nexport class Population\r\n{\r\n    private snakes: Snake[];\r\n    public bestSnake: Snake;\r\n\r\n    private bestSnakeScore: number = 0;\r\n    public gen: number = 0;\r\n    private samebest: number = 0;\r\n\r\n    public bestFitness: number = 0;\r\n    private fitnessSum: number = 0;\r\n\r\n    constructor(size: number)\r\n    {\r\n        this.snakes = []\r\n        for (let i = 0; i < size; i++)\r\n        {\r\n            this.snakes[i] = new Snake();\r\n        }\r\n        this.bestSnake = this.snakes[0].clone();\r\n        this.bestSnake.replay = true;\r\n    }\r\n\r\n    done(): boolean\r\n    {  //check if all the snakes in the population are dead\r\n        for (let i = 0; i < this.snakes.length; i++)\r\n        {\r\n            if (!this.snakes[i].dead)\r\n                return false;\r\n        }\r\n        if (!this.bestSnake.dead)\r\n        {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    update(): void\r\n    {  //update all the snakes in the generation\r\n        if (!this.bestSnake.dead)\r\n        {  //if the best snake is not dead update it, this snake is a replay of the best from the past generation\r\n            this.bestSnake.look();\r\n            this.bestSnake.think();\r\n            this.bestSnake.move();\r\n        }\r\n        for (let i = 0; i < this.snakes.length; i++)\r\n        {\r\n            if (!this.snakes[i].dead)\r\n            {\r\n                this.snakes[i].look();\r\n                this.snakes[i].think();\r\n                this.snakes[i].move();\r\n            }\r\n        }\r\n    }\r\n\r\n    show(): void\r\n    {  //show either the best snake or all the snakes\r\n        if (replayBest)\r\n        {\r\n            this.bestSnake.show();\r\n            this.bestSnake.brain.show(0, 0, 360, 790, this.bestSnake.vision, this.bestSnake.decision);  //show the brain of the best snake\r\n        }\r\n        else\r\n        {\r\n            for (let i = 0; i < this.snakes.length; i++)\r\n            {\r\n                this.snakes[i].show();\r\n            }\r\n        }\r\n    }\r\n\r\n    setBestSnake(): void\r\n    {  //set the best snake of the generation\r\n        let max = 0;\r\n        let maxIndex = 0;\r\n        for (let i = 0; i < this.snakes.length; i++)\r\n        {\r\n            if (this.snakes[i].fitness > max)\r\n            {\r\n                max = this.snakes[i].fitness;\r\n                maxIndex = i;\r\n            }\r\n        }\r\n        if (max > this.bestFitness)\r\n        {\r\n            this.bestFitness = max;\r\n            this.bestSnake = this.snakes[maxIndex].cloneForReplay();\r\n            this.bestSnakeScore = this.snakes[maxIndex].score;\r\n            //samebest = 0;\r\n            //mutationRate = defaultMutation;\r\n        }\r\n        else\r\n        {\r\n            this.bestSnake = this.bestSnake.cloneForReplay();\r\n            /*\r\n            samebest++;\r\n            if(samebest > 2) {  //if the best snake has remained the same for more than 3 generations, raise the mutation rate\r\n               mutationRate *= 2;\r\n               samebest = 0;\r\n            }*/\r\n        }\r\n    }\r\n\r\n    selectParent(): Snake\r\n    {  //selects a random number in range of the fitnesssum and if a snake falls in that range then select it\r\n        let rand = random(this.fitnessSum);\r\n        let summation = 0;\r\n        for (let i = 0; i < this.snakes.length; i++)\r\n        {\r\n            summation += this.snakes[i].fitness;\r\n            if (summation > rand)\r\n            {\r\n                return this.snakes[i];\r\n            }\r\n        }\r\n        return this.snakes[0];\r\n    }\r\n\r\n    naturalSelection(): void\r\n    {\r\n        let newSnakes = [];\r\n\r\n        this.setBestSnake();\r\n        this.calculateFitnessSum();\r\n\r\n        newSnakes[0] = this.bestSnake.clone();  //add the best snake of the prior generation into the new generation\r\n        for (let i = 1; i < this.snakes.length; i++)\r\n        {\r\n            let child = this.selectParent().crossover(this.selectParent());\r\n            child.mutate();\r\n            newSnakes[i] = child;\r\n        }\r\n        this.snakes = [];\r\n        for (let s of newSnakes)\r\n        {\r\n            this.snakes.push(s.clone());\r\n        }\r\n        this.gen += 1;\r\n    }\r\n\r\n    mutate(): void\r\n    {\r\n        for (let i = 1; i < this.snakes.length; i++)\r\n        {  //start from 1 as to not override the best snake placed in index 0\r\n            this.snakes[i].mutate();\r\n        }\r\n    }\r\n\r\n    calculateFitness(): void\r\n    {  //calculate the fitnesses for each snake\r\n        for (let i = 0; i < this.snakes.length; i++)\r\n        {\r\n            this.snakes[i].calculateFitness();\r\n        }\r\n    }\r\n\r\n    calculateFitnessSum(): void\r\n    {  //calculate the sum of all the snakes fitnesses\r\n        this.fitnessSum = 0;\r\n        for (let i = 0; i < this.snakes.length; i++)\r\n        {\r\n            this.fitnessSum += this.snakes[i].fitness;\r\n        }\r\n    }\r\n}\r\n","/// <reference path=\"./global.d.ts\" />\r\n\r\nimport * as p5_global from \"p5/global\"\r\nimport * as p5 from \"p5\"\r\n\r\nimport { Food } from \"./Food\";\r\nimport { NeuralNet } from \"./NeuralNet\";\r\n\r\nexport class Snake\r\n{\r\n    public score: number = 1;\r\n    public lifeLeft: number = 200;  // Amount of moves the snake can make before it dies\r\n    public lifetime: number = 0;  // Amount of time the snake has been alive\r\n    private xVel: number;\r\n    private yVel: number;\r\n    private foodItterate: number = 0;  //itterator to run through the foodlist (used for replay)\r\n\r\n    public fitness: number = 0;\r\n\r\n    public dead: boolean = false;\r\n    public replay: boolean = false;  //if this snake is a replay of best snake\r\n\r\n    public vision: number[];  //snakes vision\r\n    public decision: number[];  //snakes decision\r\n\r\n    private head: p5.Vector;\r\n\r\n    private body: p5.Vector[];  //snakes body\r\n    private foodList: Food[];  //list of food positions (used to replay the best snake)\r\n\r\n    private food: Food;\r\n    public brain: NeuralNet;\r\n\r\n    constructor(layers: number = null)\r\n    {\r\n        if (layers == null)\r\n        {\r\n            layers = hidden_layers;\r\n        }\r\n\r\n        this.head = createVector(800, height / 2);\r\n        this.food = new Food();\r\n        this.body = [];\r\n\r\n        if (!humanPlaying)\r\n        {\r\n            this.vision = new Array<number>(24)\r\n            this.decision = new Array<number>(4)\r\n            this.foodList = []\r\n            this.foodList.push(this.food.clone());\r\n            this.brain = new NeuralNet(24, hidden_nodes, 4, layers);\r\n            this.body.push(createVector(800, (height / 2) + SIZE));\r\n            this.body.push(createVector(800, (height / 2) + (2 * SIZE)));\r\n            this.score += 2;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    static FromFoods(foods: Food[]): Snake\r\n    {  //this constructor passes in a list of food positions so that a replay can replay the best snake\r\n        let snake = new Snake();\r\n\r\n        snake.replay = true;\r\n        snake.vision = new Array<number>(24);\r\n        snake.decision = new Array<number>(4);\r\n        snake.body = [];\r\n        snake.foodList = [];\r\n        for (let f of foods)\r\n        {  //clone all the food positions in the foodlist\r\n            snake.foodList.push(f.clone());\r\n        }\r\n        snake.food = snake.foodList[snake.foodItterate];\r\n        snake.foodItterate++;\r\n        snake.head = createVector(800, height / 2);\r\n        snake.body.push(createVector(800, (height / 2) + SIZE));\r\n        snake.body.push(createVector(800, (height / 2) + (2 * SIZE)));\r\n        snake.score += 2;\r\n\r\n        return snake;\r\n    }\r\n\r\n    bodyCollide(x: number, y: number): boolean\r\n    {  //check if a position collides with the snakes body\r\n        for (let i = 0; i < this.body.length; i++)\r\n        {\r\n            if (x == this.body[i].x && y == this.body[i].y)\r\n            {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    foodCollide(x: number, y: number): boolean\r\n    {  //check if a position collides with the food\r\n        if (x == this.food.pos.x && y == this.food.pos.y)\r\n        {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    wallCollide(x: number, y: number): boolean\r\n    {  //check if a position collides with the wall\r\n        if (x >= width - (SIZE) || x < 400 + SIZE || y >= height - (SIZE) || y < SIZE)\r\n        {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    show(): void\r\n    {  //show the snake\r\n        this.food.show();\r\n        fill(255);\r\n        stroke(0);\r\n        for (let i = 0; i < this.body.length; i++)\r\n        {\r\n            rect(this.body[i].x, this.body[i].y, SIZE, SIZE);\r\n        }\r\n        if (this.dead)\r\n        {\r\n            fill(150);\r\n        } else\r\n        {\r\n            fill(255);\r\n        }\r\n        rect(this.head.x, this.head.y, SIZE, SIZE);\r\n    }\r\n\r\n    move(): void\r\n    {  //move the snake\r\n        if (!this.dead)\r\n        {\r\n            if (!humanPlaying && !modelLoaded)\r\n            {\r\n                this.lifetime++;\r\n                this.lifeLeft--;\r\n            }\r\n            if (this.foodCollide(this.head.x, this.head.y))\r\n            {\r\n                this.eat();\r\n            }\r\n            this.shiftBody();\r\n            if (this.wallCollide(this.head.x, this.head.y))\r\n            {\r\n                this.dead = true;\r\n            } else if (this.bodyCollide(this.head.x, this.head.y))\r\n            {\r\n                this.dead = true;\r\n            } else if (this.lifeLeft <= 0 && !humanPlaying)\r\n            {\r\n                this.dead = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    eat(): void\r\n    {  //eat food\r\n        let len = this.body.length - 1;\r\n        this.score++;\r\n        if (!humanPlaying && !modelLoaded)\r\n        {\r\n            if (this.lifeLeft < 500)\r\n            {\r\n                if (this.lifeLeft > 400)\r\n                {\r\n                    this.lifeLeft = 500;\r\n                } else\r\n                {\r\n                    this.lifeLeft += 100;\r\n                }\r\n            }\r\n        }\r\n        if (len >= 0)\r\n        {\r\n            this.body.push(createVector(this.body[len].x, this.body[len].y));\r\n        } else\r\n        {\r\n            this.body.push(createVector(this.head.x, this.head.y));\r\n        }\r\n        if (!this.replay)\r\n        {\r\n            this.food = new Food();\r\n            while (this.bodyCollide(this.food.pos.x, this.food.pos.y))\r\n            {\r\n                this.food = new Food();\r\n            }\r\n            if (!humanPlaying)\r\n            {\r\n                this.foodList.push(this.food);\r\n            }\r\n        } else\r\n        {  //if the snake is a replay, then we dont want to create new random foods, we want to see the positions the best snake had to collect\r\n            this.food = this.foodList[this.foodItterate];\r\n            this.foodItterate++;\r\n        }\r\n    }\r\n\r\n    shiftBody(): void\r\n    {  //shift the body to follow the head\r\n        let tempx = this.head.x;\r\n        let tempy = this.head.y;\r\n        this.head.x += this.xVel;\r\n        this.head.y += this.yVel;\r\n        let temp2x: number;\r\n        let temp2y: number;\r\n        for (let i = 0; i < this.body.length; i++)\r\n        {\r\n            temp2x = this.body[i].x;\r\n            temp2y = this.body[i].y;\r\n            this.body[i].x = tempx;\r\n            this.body[i].y = tempy;\r\n            tempx = temp2x;\r\n            tempy = temp2y;\r\n        }\r\n    }\r\n\r\n    cloneForReplay(): Snake\r\n    {  //clone a version of the snake that will be used for a replay\r\n        let clone = Snake.FromFoods(this.foodList);\r\n        clone.brain = this.brain.clone();\r\n        return clone;\r\n    }\r\n\r\n    clone(): Snake\r\n    {  //clone the snake\r\n        let clone = new Snake(hidden_layers);\r\n        clone.brain = this.brain.clone();\r\n        return clone;\r\n    }\r\n\r\n    crossover(parent: Snake): Snake\r\n    {  //crossover the snake with another snake\r\n        let child = new Snake(hidden_layers);\r\n        child.brain = this.brain.crossover(parent.brain);\r\n        return child;\r\n    }\r\n\r\n    mutate(): void\r\n    {  //mutate the snakes brain\r\n        this.brain.mutate(mutationRate);\r\n    }\r\n\r\n    calculateFitness(): void\r\n    {  //calculate the fitness of the snake\r\n        if (this.score < 10)\r\n        {\r\n            this.fitness = floor(this.lifetime * this.lifetime) * pow(2, this.score);\r\n        } else\r\n        {\r\n            this.fitness = floor(this.lifetime * this.lifetime);\r\n            this.fitness *= pow(2, 10);\r\n            this.fitness *= (this.score - 9);\r\n        }\r\n    }\r\n\r\n    look()\r\n    {  //look in all 8 directions and check for food, body and wall\r\n        this.vision = [];\r\n        let temp = this.lookInDirection(createVector(-SIZE, 0));\r\n        this.vision[0] = temp[0];\r\n        this.vision[1] = temp[1];\r\n        this.vision[2] = temp[2];\r\n        temp = this.lookInDirection(createVector(-SIZE, -SIZE));\r\n        this.vision[3] = temp[0];\r\n        this.vision[4] = temp[1];\r\n        this.vision[5] = temp[2];\r\n        temp = this.lookInDirection(createVector(0, -SIZE));\r\n        this.vision[6] = temp[0];\r\n        this.vision[7] = temp[1];\r\n        this.vision[8] = temp[2];\r\n        temp = this.lookInDirection(createVector(SIZE, -SIZE));\r\n        this.vision[9] = temp[0];\r\n        this.vision[10] = temp[1];\r\n        this.vision[11] = temp[2];\r\n        temp = this.lookInDirection(createVector(SIZE, 0));\r\n        this.vision[12] = temp[0];\r\n        this.vision[13] = temp[1];\r\n        this.vision[14] = temp[2];\r\n        temp = this.lookInDirection(createVector(SIZE, SIZE));\r\n        this.vision[15] = temp[0];\r\n        this.vision[16] = temp[1];\r\n        this.vision[17] = temp[2];\r\n        temp = this.lookInDirection(createVector(0, SIZE));\r\n        this.vision[18] = temp[0];\r\n        this.vision[19] = temp[1];\r\n        this.vision[20] = temp[2];\r\n        temp = this.lookInDirection(createVector(-SIZE, SIZE));\r\n        this.vision[21] = temp[0];\r\n        this.vision[22] = temp[1];\r\n        this.vision[23] = temp[2];\r\n    }\r\n\r\n    lookInDirection(direction: p5.Vector): number[]\r\n    {  //look in a direction and check for food, body and wall\r\n        let look = [0, 0, 0]\r\n        let pos = createVector(this.head.x, this.head.y);\r\n        let distance: number = 0;\r\n        let foodFound: boolean = false;\r\n        let bodyFound: boolean = false;\r\n        pos.add(direction);\r\n        distance += 1;\r\n        while (!this.wallCollide(pos.x, pos.y))\r\n        {\r\n            if (!foodFound && this.foodCollide(pos.x, pos.y))\r\n            {\r\n                foodFound = true;\r\n                look[0] = 1;\r\n            }\r\n            if (!bodyFound && this.bodyCollide(pos.x, pos.y))\r\n            {\r\n                bodyFound = true;\r\n                look[1] = 1;\r\n            }\r\n            if (this.replay && seeVision)\r\n            {\r\n                stroke(0, 255, 0);\r\n                point(pos.x, pos.y);\r\n                if (foodFound)\r\n                {\r\n                    noStroke();\r\n                    fill(255, 255, 51);\r\n                    ellipseMode(CENTER);\r\n                    ellipse(pos.x, pos.y, 5, 5);\r\n                }\r\n                if (bodyFound)\r\n                {\r\n                    noStroke();\r\n                    fill(102, 0, 102);\r\n                    ellipseMode(CENTER);\r\n                    ellipse(pos.x, pos.y, 5, 5);\r\n                }\r\n            }\r\n            pos.add(direction);\r\n            distance += 1;\r\n        }\r\n        if (this.replay && seeVision)\r\n        {\r\n            noStroke();\r\n            fill(0, 255, 0);\r\n            ellipseMode(CENTER);\r\n            ellipse(pos.x, pos.y, 5, 5);\r\n        }\r\n        look[2] = 1 / distance;\r\n        return look;\r\n    }\r\n\r\n    think()\r\n    {  //think about what direction to move\r\n        this.decision = this.brain.output(this.vision);\r\n        let maxIndex = 0;\r\n        let max = 0;\r\n        for (let i = 0; i < this.decision.length; i++)\r\n        {\r\n            if (this.decision[i] > max)\r\n            {\r\n                max = this.decision[i];\r\n                maxIndex = i;\r\n            }\r\n        }\r\n\r\n        switch (maxIndex)\r\n        {\r\n            case 0:\r\n                this.moveUp();\r\n                break;\r\n            case 1:\r\n                this.moveDown();\r\n                break;\r\n            case 2:\r\n                this.moveLeft();\r\n                break;\r\n            case 3:\r\n                this.moveRight();\r\n                break;\r\n        }\r\n    }\r\n\r\n    moveUp(): void\r\n    {\r\n        if (this.yVel != SIZE)\r\n        {\r\n            this.xVel = 0;\r\n            this.yVel = -SIZE;\r\n        }\r\n    }\r\n\r\n    moveDown(): void\r\n    {\r\n        if (this.yVel != -SIZE)\r\n        {\r\n            this.xVel = 0;\r\n            this.yVel = SIZE;\r\n        }\r\n    }\r\n\r\n    moveLeft(): void\r\n    {\r\n        if (this.xVel != SIZE)\r\n        {\r\n            this.xVel = -SIZE;\r\n            this.yVel = 0;\r\n        }\r\n    }\r\n\r\n    moveRight(): void\r\n    {\r\n        if (this.xVel != -SIZE)\r\n        {\r\n            this.xVel = SIZE;\r\n            this.yVel = 0;\r\n        }\r\n    }\r\n}\r\n","/// <reference path=\"./global.d.ts\" />\r\n\r\nimport * as p5_global from \"p5/global\"\r\nimport * as p5 from \"p5\"\r\n\r\nimport { Button } from \"./Button\";\r\nimport { Snake } from \"./Snake\";\r\nimport { Population } from \"./Population\";\r\n\r\nwindow.SIZE = 20;\r\nwindow.hidden_nodes = 16;\r\nwindow.hidden_layers = 2;\r\nwindow.fps = 100;  //15 is ideal for self play, increasing for AI does not directly increase speed, speed is dependant on processing power\r\n\r\nwindow.highscore = 0;\r\n\r\nwindow.mutationRate = 0.05;\r\nwindow.defaultmutation = mutationRate;\r\n\r\nwindow.humanPlaying = false;  //false for AI, true to play yourself\r\nwindow.replayBest = true;  //shows only the best of each generation\r\nwindow.seeVision = false;  //see the snakes vision\r\nwindow.modelLoaded = false;\r\n\r\nlet increaseMut: Button;\r\nlet decreaseMut: Button;\r\n\r\nlet snake: Snake;\r\nlet model: Snake;\r\n\r\nlet pop: Population;\r\n\r\nwindow.setup = function (): void\r\n{\r\n    createCanvas(1200, 800);\r\n    increaseMut = new Button(340, 125, 20, 20, \"+\");\r\n    decreaseMut = new Button(365, 125, 20, 20, \"-\");\r\n    frameRate(fps);\r\n\r\n    if (humanPlaying)\r\n    {\r\n        snake = new Snake();\r\n    }\r\n    else\r\n    {\r\n        pop = new Population(2000); //adjust size of population\r\n    }\r\n}\r\n\r\nwindow.draw = function (): void\r\n{\r\n    background(0);\r\n    noFill();\r\n    stroke(255);\r\n    line(400, 0, 400, height);\r\n    rectMode(CORNER);\r\n    rect(400 + SIZE, SIZE, width - 400 - 40, height - 40);\r\n\r\n    if (humanPlaying)\r\n    {\r\n        snake.move();\r\n        snake.show();\r\n        fill(150);\r\n        textSize(20);\r\n        text(\"SCORE : \" + snake.score, 500, 50);\r\n\r\n        if (snake.dead)\r\n        {\r\n            snake = new Snake();\r\n        }\r\n    }\r\n    else\r\n    {\r\n        if (!modelLoaded)\r\n        {\r\n            if (pop.done())\r\n            {\r\n                highscore = pop.bestSnake.score;\r\n                pop.calculateFitness();\r\n                pop.naturalSelection();\r\n            } \r\n            else\r\n            {\r\n                pop.update();\r\n                pop.show();\r\n            }\r\n\r\n            fill(150);\r\n            textSize(25);\r\n            textAlign(LEFT);\r\n            text(\"BEST FITNESS : \" + pop.bestFitness, 120, 25);\r\n            text(\"MOVES LEFT : \" + pop.bestSnake.lifeLeft, 120, 50);\r\n            text(\"GEN : \" + pop.gen, 120, 75);\r\n            text(\"MUTATION RATE : \" + mutationRate * 100 + \"%\", 120, 100);\r\n            text(\"SCORE : \" + pop.bestSnake.score, 120, height - 45);\r\n            text(\"HIGHSCORE : \" + highscore, 120, height - 15);\r\n            increaseMut.show();\r\n            decreaseMut.show();\r\n        }\r\n        else\r\n        {\r\n            model.look();\r\n            model.think();\r\n            model.move();\r\n            model.show();\r\n            model.brain.show(0, 0, 360, 790, model.vision, model.decision);\r\n\r\n            if (model.dead)\r\n            {\r\n                let newmodel = new Snake();\r\n                newmodel.brain = model.brain.clone();\r\n                model = newmodel;\r\n\r\n            }\r\n\r\n            textSize(25);\r\n            fill(150);\r\n            textAlign(LEFT);\r\n            text(\"SCORE : \" + model.score, 120, height - 45);\r\n        }\r\n\r\n        textAlign(LEFT);\r\n        textSize(18);\r\n        fill(255, 0, 0);\r\n        text(\"RED < 0\", 120, height - 75);\r\n        fill(0, 0, 255);\r\n        text(\"BLUE > 0\", 200, height - 75);\r\n    }\r\n\r\n}\r\n\r\nwindow.mousePressed = function (): void\r\n{\r\n    if (increaseMut.collide(mouseX, mouseY))\r\n    {\r\n        mutationRate *= 2;\r\n        defaultmutation = mutationRate;\r\n    }\r\n\r\n    if (decreaseMut.collide(mouseX, mouseY))\r\n    {\r\n        mutationRate /= 2;\r\n        defaultmutation = mutationRate;\r\n    }\r\n}\r\n\r\nwindow.keyPressed = function (): void\r\n{\r\n    if (humanPlaying)\r\n    {\r\n        switch (keyCode)\r\n        {\r\n            case UP_ARROW:\r\n                snake.moveUp();\r\n                break;\r\n            case DOWN_ARROW:\r\n                snake.moveDown();\r\n                break;\r\n            case LEFT_ARROW:\r\n                snake.moveLeft();\r\n                break;\r\n            case RIGHT_ARROW:\r\n                snake.moveRight();\r\n                break;\r\n        }\r\n    }\r\n}\r\n"],"sourceRoot":""}